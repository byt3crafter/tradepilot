<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy"
    content="frame-ancestors 'self' https://sandbox-buy.paddle.com https://buy.paddle.com https://*.paddle.com;">
  <title>JTradePilot</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">

  <!-- Favicon Configuration -->
  <link rel="icon" type="image/png" sizes="32x32" href="/JTP_logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/JTP_logo.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JTP_logo.png">

  <!-- UnicornStudio Animated Background - Landing Page Only (Loaded by React) -->
  <script type="text/javascript">
    // Global function for React to load UnicornStudio when on landing page
    window.loadUnicornStudio = function () {
      if (window.UnicornStudio && window.UnicornStudio.isInitialized) {
        return; // Already loaded
      }

      if (!window.UnicornStudio) {
        window.UnicornStudio = { isInitialized: false };
      }

      var i = document.createElement("script");
      i.src = "https://cdn.jsdelivr.net/gh/hiunicornstudio/unicornstudio.js@v1.4.29/dist/unicornStudio.umd.js";
      i.onload = function () {
        if (window.UnicornStudio && !window.UnicornStudio.isInitialized) {
          if (window.UnicornStudio.init) window.UnicornStudio.init();
          window.UnicornStudio.isInitialized = true;
        }
      };
      (document.head || document.body).appendChild(i);
    };

    // Create or remove animated background
    window.showAnimatedBackground = function (show) {
      const bgContainer = document.getElementById('animated-background-container');
      if (!bgContainer) return;

      if (show) {
        // Only create background if it doesn't exist
        if (bgContainer.children.length === 0) {
          bgContainer.innerHTML = `
            <div class="aura-background-component fixed top-0 w-full h-screen z-0 pointer-events-none" data-alpha-mask="80"
              style="mask-image: linear-gradient(to bottom, transparent 0%, black 20%, black 70%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 20%, black 70%, transparent 100%);">
              <div data-us-project="0WrRbFIPaKoWVkiQWBG0" class="absolute w-full h-full left-0 top-0"></div>
            </div>

            <div class="fixed inset-0 z-0 pointer-events-none" style="
              background-image:
                linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
              background-size: 60px 60px;
              background-attachment: fixed;
              mask-image: radial-gradient(ellipse 100% 50% at 50% 50%, black 30%, transparent 100%);
              -webkit-mask-image: radial-gradient(ellipse 100% 50% at 50% 50%, black 30%, transparent 100%);
            "></div>

            <div class="fixed inset-0 z-10 pointer-events-none" style="
              background: radial-gradient(circle at center, transparent 0%, #08090A 100%);
              opacity: 0.8;
            "></div>
          `;
        }
      } else {
        // Remove background content
        bgContainer.innerHTML = '';
      }
    };
  </script>

  <!-- Add Charting Libraries -->
  <script src="https://unpkg.com/d3@7.8.5/dist/d3.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react-dom": "https://aistudiocdn.com/react-dom@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "crypto": "https://aistudiocdn.com/crypto@^1.0.1",
    "express": "https://aistudiocdn.com/express@^5.1.0",
    "rxjs": "https://aistudiocdn.com/rxjs@^7.8.2",
    "rxjs/": "https://aistudiocdn.com/rxjs@^7.8.2/",
    "supertest": "https://aistudiocdn.com/supertest@^7.1.4",
    "joi": "https://aistudiocdn.com/joi@^18.0.1",
    "nodemailer": "https://aistudiocdn.com/nodemailer@^7.0.6",
    "class-validator": "https://aistudiocdn.com/class-validator@^0.14.2",
    "@nestjs/core": "https://aistudiocdn.com/@nestjs/core@^11.1.6",
    "class-transformer": "https://aistudiocdn.com/class-transformer@^0.5.1",
    "@nestjs/testing": "https://aistudiocdn.com/@nestjs/testing@^11.1.6",
    "passport-jwt": "https://aistudiocdn.com/passport-jwt@^4.0.1",
    "@nestjs/common": "https://aistudiocdn.com/@nestjs/common@^11.1.6",
    "@jest/globals": "https://aistudiocdn.com/@jest/globals@^30.1.2",
    "@nestjs/config": "https://aistudiocdn.com/@nestjs/config@^4.0.2",
    "cookie-parser": "https://aistudiocdn.com/cookie-parser@^1.4.7",
    "compression": "https://aistudiocdn.com/compression@^1.8.1",
    "@prisma/client": "https://aistudiocdn.com/@prisma/client@^6.16.2",
    "helmet": "https://aistudiocdn.com/helmet@^8.1.0",
    "@nestjs/jwt": "https://aistudiocdn.com/@nestjs/jwt@^11.0.0",
    "child_process": "https://aistudiocdn.com/child_process@^1.0.2",
    "@nestjs/passport": "https://aistudiocdn.com/@nestjs/passport@^11.0.5",
    "@nestjs/throttler": "https://aistudiocdn.com/@nestjs/throttler@^6.4.0",
    "md5": "https://aistudiocdn.com/md5@^2.3.0",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.20.0",
    "@paddle/paddle-node-sdk": "https://aistudiocdn.com/@paddle/paddle-node-sdk@^3.2.1",
    "src/": "https://aistudiocdn.com/src@^1.1.2/",
    "recharts": "https://aistudiocdn.com/recharts@^3.2.1",
    "lightweight-charts": "https://aistudiocdn.com/lightweight-charts@^5.0.8",
    "@nestjs/schedule": "https://aistudiocdn.com/@nestjs/schedule@^6.0.1",
    "bcryptjs": "https://aistudiocdn.com/bcryptjs@^3.0.2",
    "@clerk/clerk-react": "https://esm.sh/@clerk/clerk-react@5.2.0?external=react,react-dom",
    "@clerk/themes": "https://esm.sh/@clerk/themes@2.1.0",
    "jwks-rsa": "https://aistudiocdn.com/jwks-rsa@^3.2.0"
  }
}
</script>
</head>

<body class="font-sans text-primary antialiased selection:bg-zinc-800 selection:text-white bg-[#08090A]">

  <!-- Animated Background Container - Created dynamically by React on landing page -->
  <div id="animated-background-container"></div>

  <div id="root"></div>

  <script>
    window.APP_CONFIG = (function () {
      const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

      let apiUrl;

      if (isLocal) {
        // In development (localhost), API is on the same machine but different port
        apiUrl = 'http://localhost:8080';
      } else {
        // In production, API is on the same domain
        apiUrl = window.location.origin;
      }

      console.log('[JTradePilot] API URL configured for:', apiUrl);
      console.log('[JTradePilot] Frontend running on:', window.location.origin);

      return {
        API_URL: apiUrl
      };
    })();



    // Check current route immediately (before React loads)
    function initializeBackgroundForCurrentRoute() {
      const path = window.location.pathname;
      const isLandingPage = path === '/';
      window.showAnimatedBackground(isLandingPage);
    }

    // Initialize on page load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeBackgroundForCurrentRoute);
    } else {
      initializeBackgroundForCurrentRoute();
    }
  </script>

  <script type="module" src="/index.tsx"></script>
</body>

</html>